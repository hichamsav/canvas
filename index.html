<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8" />
    <title>EXTRACTION CANVAS</title>
    <style>
        body {
            direction: rtl;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            padding-top: 100px; /* âœ… Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
            display: flex;
            gap: 10px;
            height: 100vh;
            font-size: 13px;
            overflow: hidden; /* ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            box-sizing: border-box;
        }

        .container {
            flex: 1;
            max-width: 50%;
            display: flex;
            flex-direction: column;
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
            overflow: hidden;
        }
.header-logo {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    text-align: center;
}

.header-logo img {
    height: 60px; /* ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¬Ù… Ø­Ø³Ø¨ Ø´Ø¹Ø§Ø±Ùƒ */
    object-fit: contain;
}

        h1, h2, h3 {
            font-size: 16px;
            margin-top: 0;
            text-align: center;
        }

        input[type="file"],
        input[type="text"],
        textarea {
            width: 100%;
            font-size: 12px;
            padding: 8px;
            margin-bottom: 8px;
            box-sizing: border-box;
            font-family: monospace;
            height: 60px;
            resize: none;
        }

        button {
            padding: 6px 10px;
            font-size: 13px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            margin-bottom: 8px;
            transition: background-color 0.3s ease;
        }

            button:hover {
                background-color: #0056b3;
            }

        .copy-button {
            background-color: #28a745;
        }

            .copy-button:hover {
                background-color: #1e7e34;
            }

        .row {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
        }

        .field-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .line-count {
            font-weight: bold;
            font-size: 12px;
            color: #007bff;
            text-align: center;
            margin-bottom: 4px;
        }

        label {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 4px;
        }

            #keyword,
            label[for="keyword"] {
                display: none;
            }
    </style>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
<div class="header-logo">
    <img src="https://www.vernegroup.com/wp-content/uploads/2021/08/Image-1-1-1.png" alt="Ø§Ù„Ø´Ø¹Ø§Ø±" />
</div>

    <div class="container" style="max-width: 45%;">
        <h1 style="text-align: center;">ğŸ“ EXTRACTION CANVAS ğŸ“</h1>
        <input type="file" id="folderInput" webkitdirectory directory multiple accept=".txt,.html" />
        <button onclick="mergeFolderTxt()">Ø¯Ù…Ø¬ Ø§Ù„Ù…Ù„ÙØ§Øª</button>

<textarea id="filteredOutput" rows="10" style="display:none;"></textarea>

        <h3>ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒÙ„Ù…Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)</h3>
        <input type="text" id="singleKeywordInput" value="Envoy,Sent,ID CASE,Client :,Tï¿½lï¿½phone,Accï¿½s rï¿½seau,Activitï¿½s de service,TÃ©lÃ©phone,AccÃ¨s rÃ©seau,ActivitÃ©s de service,Commentaire,Adresse Installation" />
        <label><input type="checkbox" id="startOnlySingleCheckbox" checked /> Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙÙ‚Ø· Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„ØªÙŠ <strong>ØªØ¨Ø¯Ø£</strong> Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª</label><br />
        <button onclick="extractSingleKeyword()">ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬</button>
<textarea id="singleKeywordOutput" rows="7" readonly placeholder="Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"></textarea>
        <button onclick="copySingleKeyword()" class="copy-button">ğŸ“‹ Ù†Ø³Ø® Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬</button>
    </div>

    <div class="container" style="max-width: 50%;">
        <div class="row">
            <div class="field-container">
                <div class="line-count" id="count0">0 Ø³Ø·Ø±</div>
                <textarea id="field0" readonly></textarea>
                <button class="copy-button" onclick="copyField(0)">ğŸ“‹ Ù†Ø³Ø® EnvoyÃ©</button>
            </div>
            <div class="field-container">
                <div class="line-count" id="count1">0 Ø³Ø·Ø±</div>
                <textarea id="field1" readonly></textarea>
                <button class="copy-button" onclick="copyField(1)">ğŸ“‹ Ù†Ø³Ø® ID CASE</button>
            </div>
            <div class="field-container">
                <div class="line-count" id="count2">0 Ø³Ø·Ø±</div>
                <textarea id="field2" readonly></textarea>
                <button class="copy-button" onclick="copyField(2)">ğŸ“‹ Ù†Ø³Ø® Client</button>
            </div>
        </div>

        <div class="row">
            <div class="field-container">
                <div class="line-count" id="count3">0 Ø³Ø·Ø±</div>
                <textarea id="field3" readonly></textarea>
                <button class="copy-button" onclick="copyField(3)">ğŸ“‹ Ù†Ø³Ø® TÃ©lÃ©phone</button>
            </div>
            <div class="field-container">
                <div class="line-count" id="count4">0 Ø³Ø·Ø±</div>
                <textarea id="field4" readonly></textarea>
                <button class="copy-button" onclick="copyField(4)">ğŸ“‹ Ù†Ø³Ø® AccÃ¨s rÃ©seau</button>
            </div>
            <div class="field-container">
                <div class="line-count" id="count5">0 Ø³Ø·Ø±</div>
                <textarea id="field5" readonly></textarea>
                <button class="copy-button" onclick="copyField(5)">ğŸ“‹ Ù†Ø³Ø® ActivitÃ©s de service</button>
            </div>
        </div>

        <div class="row">
            <div class="field-container">
                <div class="line-count" id="count6">0 Ø³Ø·Ø±</div>
                <textarea id="field6" readonly></textarea>
                <button class="copy-button" onclick="copyField(6)">ğŸ“‹ Ù†Ø³Ø® Adresse Installation</button>
            </div>
        </div>

<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
    <button onclick="removeDuplicatesAndAutoCopy()" style="background-color:#dc3545; color:white;">ğŸ§¹ Remove & Copy ALL ğŸ§¹ </button>
    <button onclick="exportToExcel()" style="background-color:#ff6600; color:white;">â¬‡ï¸ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel</button>
    <span id="countdown" style="font-weight: bold; color: red; font-size: 14px; margin-right: 10px;"></span>
</div>

<script>
    document.addEventListener("contextmenu", e => e.preventDefault());
    document.addEventListener("keydown", e => {
        if (e.key === "F12" || (e.ctrlKey && ["u", "s"].includes(e.key.toLowerCase())) || (e.ctrlKey && e.shiftKey && ["I", "J"].includes(e.key))) { e.preventDefault(); return false; }
    });

    let originalMergedContent = "";

function mergeFolderTxt() {
    const files = Array.from(document.getElementById("folderInput").files).filter(f => f.name.toLowerCase().endsWith(".txt"));
    if (!files.length) {
        alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù„Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª .txt.");
        return;
    }

    files.sort((a, b) => a.name.localeCompare(b.name));
    let merged = "";
    let processed = 0;

    files.forEach(f => {
        const reader = new FileReader();
        reader.onload = e => {
            merged += `\n===== ${f.name} =====\n` + e.target.result + "\n";
            processed++;
            if (processed === files.length) {
                originalMergedContent = merged;
                document.getElementById("filteredOutput").value = merged;
                extractSingleKeyword();

                // âœ… Ø£ÙˆÙ„ Ø¶ØºØ·Ø© Ø¨Ø¹Ø¯ 0.001 Ø«Ø§Ù†ÙŠØ©
                setTimeout(() => {
                    const copyAllButton = Array.from(document.querySelectorAll('button'))
                        .find(btn => btn.textContent.includes("ğŸ§¹"));
                    if (copyAllButton) copyAllButton.click();

                    // âœ… Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ø¶ØºØ·Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ â†’ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹
                    setTimeout(() => {
                        let fastPress = setInterval(() => {
                            const copyAllButton = Array.from(document.querySelectorAll('button'))
                                .find(btn => btn.textContent.includes("ğŸ§¹"));
                            if (copyAllButton) copyAllButton.click();
                        }, 1); // 0.001 Ø«Ø§Ù†ÙŠØ© â‰ˆ 1ms

                        // â±ï¸ ØªÙˆÙ‚Ù Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø©
                        setTimeout(() => {
                            clearInterval(fastPress);
                        }, 60000);

                    }, 15000); // Ø¨Ø¹Ø¯ 15 Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ø¶ØºØ·Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰

                }, 1); // Ø£ÙˆÙ„ Ø¶ØºØ·Ø© Ø¨Ø¹Ø¯ 0.001 Ø«Ø§Ù†ÙŠØ©
            }
        };
        reader.readAsText(f);
    });
}
</script>
</body>
</html>
