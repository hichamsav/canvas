<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>EXTRACTION CANVAS</title>
  <style>
    body {
      direction: rtl;
      font-family: Arial, sans-serif;
      margin: 0; padding: 20px;
      display: flex;
      gap: 20px;
      height: 100vh;
      box-sizing: border-box;
    }
    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
    }
    h2 {
      margin-top: 0;
      text-align: center;
    }
    input[type="file"] {
      margin-bottom: 10px;
    }
    button {
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      margin-bottom: 15px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #0056b3;
    }
    textarea, input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 13px;
      margin-bottom: 10px;
      box-sizing: border-box;
      resize: vertical;
      font-family: monospace, monospace;
    }
    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .field-container {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .field-container textarea {
      height: 90px;
      resize: vertical;
    }
    .copy-button {
      margin-top: 5px;
      background-color: #28a745;
    }
    .copy-button:hover {
      background-color: #1e7e34;
    }
    .line-count {
      font-weight: bold;
      margin-bottom: 5px;
      color: #007bff;
      text-align: center;
      user-select: none;
    }
    label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
    }
    /* Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ù†Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª (Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ) */
    #keyword, label[for="keyword"] {
      display: none;
    }
  </style>

  <!-- Ù…ÙƒØªØ¨Ø© SheetJS -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>

  <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ - Ø±ÙØ¹ ÙˆØ¯Ù…Ø¬ Ù…Ù„ÙØ§Øª TXT -->
  <div class="container" style="max-width: 45%;">
<h1 style="text-align: center;">ğŸ“ EXTRACTION CANVAS ğŸ“</h1>
    <input type="file" id="folderInput" webkitdirectory directory multiple accept=".txt" />
    <button onclick="mergeFolderTxt()">Ø¯Ù…Ø¬ Ø§Ù„Ù…Ù„ÙØ§Øª</button>

    <!-- Ø§Ù„Ù†Øµ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬ Ù…Ø®ÙÙŠ -->
    <textarea id="filteredOutput" rows="10" style="display:none;"></textarea>

    <h3>ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒÙ„Ù…Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)</h3>
    <input
      type="text"
      id="singleKeywordInput"
      value="ID CASE,Client :,Tï¿½lï¿½phone,Accï¿½s rï¿½seau,Activitï¿½s de service,Commentaire,Adresse Installation"
      placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø£ÙƒØ«Ø± Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©"
    />
    <label>
      <input type="checkbox" id="startOnlySingleCheckbox" checked />
      Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙÙ‚Ø· Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„ØªÙŠ <strong>ØªØ¨Ø¯Ø£</strong> Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª
    </label><br />
    <button onclick="extractSingleKeyword()">ğŸ” Ø§Ø³ØªØ®Ø±Ø§Ø¬</button>
    <textarea id="singleKeywordOutput" rows="7" readonly placeholder="Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"></textarea>
    <button onclick="copySingleKeyword()" class="copy-button">ğŸ“‹ Ù†Ø³Ø® Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬</button>
  </div>

  <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø§Ù„ÙÙ„ØªØ±Ø© ÙˆØ§Ù„ØªÙˆØ²ÙŠØ¹ -->
  <div class="container" style="max-width: 50%;">
    <label for="keyword">ğŸ” Ø§Ù„ÙƒÙ„Ù…Ø§Øª (Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨Ù€ +):</label>
    <input type="text" id="keyword" placeholder="Ù…Ø«Ø§Ù„: Ø®Ø·Ø£+ÙØ´Ù„+ØªØ­Ø°ÙŠØ±" value="SANS CA" />
    <button onclick="filterAndDistribute()" style="display:none;">ğŸš€ ØªÙ†ÙÙŠØ°</button>
<!-- ğŸŸ¦ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„: Ø®Ø§Ù†Ø§Øª 1ØŒ 2ØŒ 3 -->
<div class="row">
  <div class="field-container">
    <div class="line-count" id="count1">0 Ø³Ø·Ø±</div>
    <textarea id="field1" readonly></textarea>
    <button class="copy-button" onclick="copyField(1)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 1</button>
  </div>
  <div class="field-container">
    <div class="line-count" id="count2">0 Ø³Ø·Ø±</div>
    <textarea id="field2" readonly></textarea>
    <button class="copy-button" onclick="copyField(2)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 2</button>
  </div>
  <div class="field-container">
    <div class="line-count" id="count3">0 Ø³Ø·Ø±</div>
    <textarea id="field3" readonly></textarea>
    <button class="copy-button" onclick="copyField(3)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 3</button>
  </div>
</div>

<!-- âœ… Ø§Ù„ØªØ§Ø±ÙŠØ®: ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ Ø¨ÙŠÙ† Ø§Ù„ØµÙÙŠÙ† -->
<div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap; margin: 20px 0; justify-content: center;">
  <strong>ğŸ—“ï¸ Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong>

  <label style="display: flex; align-items: center; gap: 5px;">
    <input type="radio" name="dateOption" value="today" checked>
    Ø§Ù„ÙŠÙˆÙ…
  </label>

  <label style="display: flex; align-items: center; gap: 5px;">
    <input type="radio" name="dateOption" value="yesterday">
    Ø§Ù„Ø¨Ø§Ø±Ø­Ø©
  </label>

  <label style="display: flex; align-items: center; gap: 5px;">
    <input type="radio" name="dateOption" value="custom">
    Ù…Ø®ØµØµ
  </label>

  <input type="date" id="customDateInput" style="padding: 5px;" />
</div>

<!-- ğŸŸ© Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø®Ø§Ù†Ø§Øª 4ØŒ 5ØŒ 6 -->
<div class="row">
  <div class="field-container">
    <div class="line-count" id="count4">0 Ø³Ø·Ø±</div>
    <textarea id="field4" readonly></textarea>
    <button class="copy-button" onclick="copyField(4)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 4</button>
  </div>
  <div class="field-container">
    <div class="line-count" id="count5">0 Ø³Ø·Ø±</div>
    <textarea id="field5" readonly></textarea>
    <button class="copy-button" onclick="copyField(5)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 5</button>
  </div>
  <div class="field-container">
    <div class="line-count" id="count6">0 Ø³Ø·Ø±</div>
    <textarea id="field6" readonly></textarea>
    <button class="copy-button" onclick="copyField(6)">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø®Ø§Ù†Ø© 6</button>
  </div>
</div>

<!-- âœ… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… (ØªØ­Øª Ø§Ù„ÙƒÙ„ØŒ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ ÙƒØ§Ù†Øª) -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
  <button onclick="removeDuplicatesBasedOnField1()" style="background-color:#dc3545; color:white;">
    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ØªÙƒØ±Ø§Ø± 
  </button>
  <button onclick="copyExcelData()" style="background-color:#28a745; color:white;">
    ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙ„
  </button>
  <button onclick="exportToExcel()" style="background-color:#ff6600; color:white;">
    â¬‡ï¸ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
  </button>
</div>





<script>

// Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ù„Ù† ØªÙØºÙŠØ± Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ´ØºÙŠÙ„
function mergeFolderTxt(){var _0x3f4b=['\x6C\x65\x6E\x67\x74\x68','\x66\x69\x6C\x65\x73'];const files=document.getElementById('folderInput')['files'];if(!files['length']){alert('\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0645\u062C\u0644\u062F \u064A\u062D\u062A\u0648\u064A \u0645\u0644\u0641\u0627\u062A .txt.');return;}let mergedContent='';let filesProcessed=0;const txtFiles=Array['from'](files)['filter'](function(file){return file['name']['toLowerCase']()['endsWith']('.txt');});if(txtFiles['length']===0){alert('\u0644\u0627 \u064A\u0648\u062C\u062F \u0645\u0644\u0641\u0627\u062A .txt \u0641\u064A \u0647\u0630\u0627 \u0627\u0644\u0645\u062C\u0644\u062F.');return;}txtFiles['sort'](function(a,b){return a['name']['localeCompare'](b['name']);});txtFiles['forEach'](function(file){const reader=new FileReader();reader['onload']=function(e){mergedContent+='\n===== '+file['name']+' =====\n'+e['target']['result']+'\n';filesProcessed++;if(filesProcessed===txtFiles['length']){originalMergedContent=mergedContent;document.getElementById('filteredOutput')['value']=mergedContent;extractSingleKeyword();}};reader['readAsText'](file);});}

</script>

</body>
</html>


